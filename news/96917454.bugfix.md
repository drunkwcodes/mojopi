Fix test. All test passed. But needs to be refined and calculate coverage.